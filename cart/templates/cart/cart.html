{% extends 'base.html' %}
{% load static %}

<body>
{% block content %}

    <!-- Page Header Start -->
    <div class="container-fluid bg-secondary mb-5">
        <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 300px">
            <h1 class="font-weight-semi-bold text-uppercase mb-3">Shopping Cart</h1>
            <div class="d-inline-flex">
                <p class="m-0"><a href="{% url 'product:home' %}">Home</a></p>
                <p class="m-0 px-2">-</p>
                <p class="m-0">Shopping Cart</p>
            </div>
        </div>
    </div>
    <!-- Page Header End -->


    <!-- Cart Start -->
    <div class="container-fluid pt-5">
        <div class="row px-xl-5">
            <div class="col-lg-8 table-responsive mb-5">
                <table class="table table-bordered text-center mb-0">
                    <thead class="bg-secondary text-dark">
                        <tr>
                            <th>Products</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Remove</th>
                        </tr>
                    </thead>
                    <!-- 0823 tbody만 수정 + 맨 아래 script추가 -->
                    <tbody class="align-middle">
                        {% for cart_item in cart_items %}
                            <tr>
                                <td class="align-middle">
                                    <img src="{{ cart_item.product.image.url }}" alt="" style="width: 50px;">
                                    {{ cart_item.product.name }}
                                </td>
                                <td class="align-middle">${{ cart_item.product.price }}</td>
                                <td class="align-middle">
                                    <div class="input-group quantity mx-auto" style="width: 100px;">
                                        <!-- Input fields for quantity -->
                                    </div>
                                </td>
                                <td class="align-middle">${{ cart_item.total_price }}</td>
                                <td class="align-middle">
                                    <a href="{% url 'cart:remove_from_cart' cart_item.product.id %}" class="btn btn-sm btn-primary"><i class="fa fa-times"></i></a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="col-lg-4">
                <form class="mb-5" action="">
                    <div class="input-group">
                        <input type="text" class="form-control p-4" placeholder="Coupon Code">
                        <div class="input-group-append">
                            <button class="btn btn-primary">Apply Coupon</button>
                        </div>
                    </div>
                </form>
                <div class="card border-secondary mb-5">
                    <div class="card-header bg-secondary border-0">
                        <h4 class="font-weight-semi-bold m-0">Cart Summary</h4>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-3 pt-1">
                            <h6 class="font-weight-medium">Subtotal</h6>
                            <h6 class="font-weight-medium">{{ cart_items|total_price }} 원</h6>
                        </div>
                        <div class="d-flex justify-content-between">
                            <h6 class="font-weight-medium">Shipping</h6>
                            <h6 class="font-weight-medium">3000원</h6>
                        </div>
                    </div>
                    <div class="card-footer border-secondary bg-transparent">
                        <div class="d-flex justify-content-between mt-2">
                            <h5 class="font-weight-bold">Total</h5>
                            <h5 class="font-weight-bold">{{ total_price|add:3000 }} 원</h5>
                        </div>
                        <button class="btn btn-block btn-primary my-3 py-3" onclick="location.href='{% url 'cart:checkout' %}'">Proceed To Checkout</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Cart End -->
    <!-- 0823 삭제버튼 동작 추가 필요없어짐-->
    <!-- Confirm 버튼을 누른 경우, 서버에 해당 상품 삭제 요청을 보낼 수 있습니다.
         예를 들어, jQuery.ajax 또는 fetch API를 사용하여 AJAX 요청을 보낼 수 있습니다.
         이 코드에서는 fetch API를 사용하여 AJAX 요청을 보내는 방법을 보여드리겠습니다. -->
<!--    <script>-->
<!--    function confirmRemove(product_id) {-->
<!--        if (confirm("Are you sure you want to remove this item from your cart?")) {-->

<!--            fetch(`/cart/remove/${product_id}/`, {-->
<!--                method: 'GET',-->
<!--                credentials: 'same-origin',-->
<!--            })-->
<!--            .then(response => {-->
<!--                if (response.ok) {-->
<!--                    location.reload();-->
<!--                } else {-->
<!--                    alert("An error occurred while removing the item.");-->
<!--                }-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error:', error);-->
<!--                alert("An error occurred while removing the item.");-->
<!--            });-->
<!--        }-->
<!--    }-->
<!--    </script>-->
{% endblock %}
</body>

</html>